<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="icon" href="favicon.ico">

	<title>Vozni red uživo!</title>

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/css/ie10-viewport-bug-workaround.css">

	<style>
		body { padding-top: 70px; }
	</style>

	<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
		<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
</head>

<body>
	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="#">Vozni red uživo!</a>
			</div>
			<div id="navbar" class="collapse navbar-collapse">
				<ul class="nav navbar-nav">
					<li class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Korisno <span class="caret"></span></a>
						<ul class="dropdown-menu">
							<li><a href="http://www.hzinfra.hr/radovi-na-pruzi02" target="_blank">HŽ Infrastruktura - Radovi na pruzi</a></li>
							<li><a href="http://hr.wikipedia.org/wiki/%C5%BDeljezni%C4%8Dke_pruge_u_Hrvatskoj" target="_blank">Željezničke pruge u Hrvatskoj</a></li>
						</ul>
					</li>
				</ul>
			</div>
		</div>
	</nav>

	<div class="container">
		<div class="jumbotron">
			<div class="starter-template">
				<p class="lead">Pregled kretanja vlaka</p>
			</div>

			<form class="form-inline" id="search">
				<div class="form-group">
					<label class="sr-only" for="trainNo">Broj vlaka</label>
					<div class="input-group">
						<input type="number" class="form-control" id="trainNo" name="trainNo" placeholder="Broj vlaka">
					</div>
				</div>
				<button type="submit" class="btn btn-primary">Traži!</button>
			</form>
		</div>
	</div>

	<div id="data" class="container">
	</div>

	<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/js/ie10-viewport-bug-workaround.js"></script>
	<script>
		$('#search').submit(function(event) {
			event.preventDefault();
			var trainNo = $('#trainNo').val();
			loadStations(trainNo);
		});

		function loadStations(trainNo) {
			$.getJSON('stations/' + trainNo, function(data) {
				if (!$.isEmptyObject(data.stations)) {
					var table = $('<table class="table"/>');
					var thead = $('<thead/>');
					var tbody = $('<tbody/>');
					var tr;

					table.append(thead);
					table.append(tbody);

					tr = $('<tr/>');

					tr.append('<th>Kolodvor</th>');
					tr.append('<th class="text-center">Dolazak</th>');
					tr.append('<th class="text-center">Kašnjenje</th>');
					tr.append('<th class="text-center">Odlazak</th>');
					tr.append('<th class="text-center">Kašnjenje</th>');

					thead.append(tr);

					$.each(data.stations, function(i, station) {
						tr = $('<tr/>');

						tr.append('<td>' + station.name + '</td>');
						tr.append(station.arrivalTime ? '<td class="text-center">' + station.arrivalTime + '</td>' : '<td/>');
						tr.append(station.arrivalDelay ? '<td class="text-center">' + station.arrivalDelay + '</td>' : '<td/>');
						tr.append(station.departureTime ? '<td class="text-center">' + station.departureTime + '</td>' : '<td/>');
						tr.append(station.departureDelay ? '<td class="text-center">' + station.departureDelay + '</td>' : '<td/>');

						tbody.append(tr);
					});

					var dataDiv = $('#data');
					dataDiv.html(table);
				}
				else {
					$('#data').html('<div class="alert alert-warning" role="alert">Ne postoji podatak o kretanju vlaka.</div>');
				}
			});
		}
	</script>
</body>
</html>
